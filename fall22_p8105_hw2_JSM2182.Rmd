---
title: "Homework 2"
author: "Jennifer Mizhquiri Barbecho"
output: github_document
---

```{r, echo = FALSE, message = FALSE}
library(tidyverse)
library(readxl) #excel
library(ggplot2)
```



# Problem 1

`
```{r, message = FALSE}
nyctransit_df = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>% # figure out how to make NAs blank
  select(line:entry, vending, ada) %>% 
  mutate(entry = recode(entry, "YES" = 1, "NO" = 0)) #when to use <-

```
```{r}
head(nyctransit_df)
```
This dataset contains administrative, compliance, and geographic data on the NYC transit system. It has `r ncol(nyctransit_df)` columns and `r nrow(nyctransit_df)` rows. At this point, the variable names have been cleaned and one variable (entry) has been recoded so that it is a 0 or 1 instead of a character. Other aspects of the data have not been further inspected so it is not tidy. 

_Additional information_

```{r addl_data, include = FALSE}
nyctransit_df %>%
  distinct(station_name, line) #is there a way for me to get the count in line


```
There are `r nrow(nyctransit_df %>% distinct(station_name,line))` distinct stations in the dataset. 
```{r, echo = FALSE}

nyctransit_df %>%
  filter(ada == TRUE) %>% 
  distinct(station_name, line) 
  
```

There are `r nrow(nyctransit_df %>% filter(ada == TRUE) %>% distinct(station_name, line))` stations that are ADA compliant. 

```{r, echo = FALSE}


  nyctransit_df %>%
  filter(vending == "NO") %>% 
  group_by(entry) %>% 
  summarize(vending_entrance = n())


#how to set it so that the false can be explicitly stated if I decided to mutate a variable 
#how to set it so that the code divides it for me as it didn't seem straightforward
```
 `r 69/(114+69)` % of stations with no vending allow entrance.

_reformat the data_

```{r, eval = FALSE}
nyctransit_long = 
  nyctransit_df %>% 
  mutate(
    route8 = as.character(route8)) %>% 
  pivot_longer(
    nyctransit_df, route1:route11,
    names_to = "route_num",
    names_prefix = "route",
    values_to = "route_name") %>% 
  mutate(
    route_num = factor(route_num)
  )
  

```

# Problem 2

_Mr. Trash wheel dataset_
  * I am adding a variable wheel with value of "mr" applying to all obs, for later merging.

```{r, echo = FALSE, message = FALSE}
mrwheels_df = 
  read_excel(
    "data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 
    sheet = "Mr. Trash Wheel", range = "A2:N535") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(
    wheel = "mr",
    sports_balls = as.integer(round(sports_balls),
    dumpster = as.character(dumpster))
  )
```


_Professor Trashwheel dataset_ 
  * I am adding a variable wheel with value of prof and applying to all obs

 * note that in professor wheels dumpster variable was numeric. to make it match what is in mr trashwheels, the variable is converted to character

_Office Hour question: How to make sure that I don't mistakenly add a variable to my original dataset_


```{r, echo = FALSE, message = FALSE}
profwheels_df = 
  read_excel(
    "data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 
    sheet = "Professor Trash Wheel", range = "A2:N117") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>%
  mutate(
    wheel = "prof",
    sports_balls = as.integer(round(sports_balls)),
    dumpster = as.character(dumpster)
  )
```

Combine both datasets into combo_wheels
```{r, echo = FALSE, message = FALSE}
combo_wheels_tidy = 
  bind_rows(mrwheels_df, profwheels_df) %>%
  janitor::clean_names()
```

_About the combined dataset_

There are `r nrow(combo_wheels_tidy)` observations in the resulting dataset. This dataset demonstrates various categories of collected items (i.e. sports balls, glass bottles, trash bottles) by weight (in tons), across years (2014 - 2021). This is helpful for generating summary stats on output and can help compare efficacy between mr. trashwheels and professor trash wheels. For example, In the year 2020, Mr. Trashwheels collected `r combo_wheels_tidy %>% filter( wheel == "mr", year == 2020) %>% summarize(sports_balls = n())` sports balls. 

```{r, eval = FALSE}
combo_wheels_tidy %>% 
  filter(
    wheel == "mr",
    year == 2020) %>% 
  summarize(sports_balls = n())
```
```{r, eval = FALSE}
combo_wheels_tidy %>%
  distinct(year) #ask why this doesn't work in inline r
```

# Problem 3

Import and clean pols-month.csv
 * note: data is sorted by year and month
 * year and month were moved to become the leading columns
 * month is a character variable and each value is renamed to their corresponding month
 * president variable was created to denote affiliation (i.e. dem = Democrat; gop = GOP)
 * 
```{r, echo = FALSE}
pols_df = 
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>% 
  janitor::clean_names() %>%
  separate(mon, into = c("year", "month", "day"), sep = "-") %>% 
  mutate(
    month = recode(month, "01" = "January", "02" = "February", "03" = "March", "04" = "April", "05" = "May", "06" = "June", "07" = "July", "08" = "August", "09" = "September", "10" = "October", "11" = "November", "12" = "December")) %>% 
  pivot_longer(
    cols = c('prez_dem','prez_gop'),
    names_to = "president", 
    names_prefix = "prez_",
    values_to = "dummy") %>% 
  select(-dummy, -day) %>% 
  select(year, month, everything()) %>% #does select always need to be broken down like this
  arrange(year, month)
  
```
```{r}
head(pols_df)
```

Import and clean snp.csv
 * note: data is sorted by year and month
 * year and month were moved to become the leading columns
 * month is a character variable and each value is renamed to their corresponding month
 * president variable was created to denote affiliation (i.e. dem = Democrat; gop = GOP)
 
 _Why did/how can i make sure my year does not get reduced to 2 digits_
```{r, echo = FALSE}
snp_df = 
  read_csv("data/fivethirtyeight_datasets/snp.csv") %>% 
  janitor::clean_names() %>%
  separate(date, into = c("month", "day", "year"), sep = "/") %>%
  mutate(
    month = recode(month, "1" = "January", "2" = "February", "3" = "March", "4" = "April", "5" = "May", "6" = "June", "7" = "July", "8" = "August", "9" = "September", "10" = "October", "11" = "November", "12" = "December")) %>% 
  select( -day) %>% 
  select(year, month, everything()) %>% 
  arrange(year, month)
  
```
```{r}
head(snp_df)
```

```{r, echo = FALSE}
unemp_df = 
  read_csv("data/fivethirtyeight_datasets/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemp_freq") %>% 
  mutate(
    month = recode(month, "jan" = "January", "feb" = "February", "mar" = "March", "apr" = "April", "may" = "May", "jun" = "June",  "jul" = "July", "aug" = "August", "sep" = "September", "oct" = "October", "nov" = "November", "dec" = "December" ),
    year = as.character(year)) %>% 
  select(year, month, everything()) %>% 
  arrange(year, month)

```

```{r}
head(unemp_df)
```


_Joining SNP TO POLS_
* in which pols is the given x data set with `r ncol(pols_df)` columns
* in which snp is the given y data set with `r ncol(snp_df)` columns

```{r}
pols_snp_df = 
  left_join(pols_df, snp_df, by = c("year" = "year", "month" = "month"))
```
  
_Joining unemployment to the SNP/POLS merged dataset_

```{r}
pols_snp_unemp_df = 
  left_join(pols_snp_df, unemp_df, by =  c("year" = "year", "month" = "month"))
```

_Combined dataset_
```{r}
head(pols_snp_unemp_df)
```


The resulting combined dataset is `r ncol(pols_snp_unemp_df)` columns by `r nrow(pols_snp_unemp_df)` rows. The year span is `r pols_snp_unemp_df %>% pull(year) %>% min()` to `r pols_snp_unemp_df %>% pull(year) %>% max()`. Key data include the frequency of senators, governors, and representatives by party affiliation, the party affiliation of the president, the close number, and the unemployment rates, all by year and month.