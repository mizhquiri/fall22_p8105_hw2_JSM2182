Homework 2
================
Jennifer Mizhquiri Barbecho

# Problem 1

\`

``` r
nyctransit_df = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>% 
  select(line:entry, vending, ada) %>% 
  mutate(entry = recode(entry, "YES" = 1, "NO" = 0)) #when to use <-
```

``` r
head(nyctransit_df)
```

    ## # A tibble: 6 × 19
    ##   line  stati…¹ stati…² stati…³ route1 route2 route3 route4 route5 route6 route7
    ##   <chr> <chr>     <dbl>   <dbl> <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> 
    ## 1 4 Av… 25th St    40.7   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  
    ## 2 4 Av… 25th St    40.7   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  
    ## 3 4 Av… 36th St    40.7   -74.0 N      R      <NA>   <NA>   <NA>   <NA>   <NA>  
    ## 4 4 Av… 36th St    40.7   -74.0 N      R      <NA>   <NA>   <NA>   <NA>   <NA>  
    ## 5 4 Av… 36th St    40.7   -74.0 N      R      <NA>   <NA>   <NA>   <NA>   <NA>  
    ## 6 4 Av… 45th St    40.6   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  
    ## # … with 8 more variables: route8 <dbl>, route9 <dbl>, route10 <dbl>,
    ## #   route11 <dbl>, entrance_type <chr>, entry <dbl>, vending <chr>, ada <lgl>,
    ## #   and abbreviated variable names ¹​station_name, ²​station_latitude,
    ## #   ³​station_longitude

This dataset contains administrative, compliance, and geographic data on
the NYC transit system. It has 19 columns and 1868 rows. At this point,
the variable names have been cleaned and one variable (entry) has been
recoded so that it is a 0 or 1 instead of a character. Other aspects of
the data have not been further inspected so it is not tidy.

*Additional information*

There are 465 distinct stations in the dataset.

    ## # A tibble: 84 × 2
    ##    line            station_name                  
    ##    <chr>           <chr>                         
    ##  1 4 Avenue        Atlantic Av-Barclays Ctr      
    ##  2 4 Avenue        DeKalb Av                     
    ##  3 4 Avenue        Pacific St                    
    ##  4 42nd St Shuttle Grand Central                 
    ##  5 6 Avenue        34th St                       
    ##  6 6 Avenue        47-50th Sts Rockefeller Center
    ##  7 6 Avenue        Church Av                     
    ##  8 63rd Street     21st St                       
    ##  9 63rd Street     Lexington Av                  
    ## 10 63rd Street     Roosevelt Island              
    ## # … with 74 more rows

There are 84 stations that are ADA compliant.

    ## # A tibble: 2 × 2
    ##   entry vending_entrance
    ##   <dbl>            <int>
    ## 1     0              114
    ## 2     1               69

0.3770492 % of stations with no vending allow entrance.

*reformat the data*

``` r
nyctransit_long = 
  nyctransit_df %>% 
  mutate(
    route8 = as.character(route8)) %>% 
  pivot_longer(
    nyctransit_df, route1:route11,
    names_to = "route_num",
    names_prefix = "route",
    values_to = "route_name") %>% 
  mutate(
    route_num = factor(route_num)
  )
```

### Problem 1

Below we import and clean data from
`NYC_Transit_Subway_Entrance_And_Exit_Data.csv`. The process begins with
data import, updates variable names, and selects the columns that will
be used in later parts fo this problem. We update `entry` from `yes` /
`no` to a logical variable. As part of data import, we specify that
`Route` columns 8-11 should be character for consistency with 1-7.

``` r
trans_ent = 
  read_csv(
    "data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
    col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>% 
  janitor::clean_names() %>% 
  select(
    line, station_name, station_latitude, station_longitude, 
    starts_with("route"), entry, exit_only, vending, entrance_type, 
    ada) %>% 
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```

As it stands, these data are not “tidy”: route number should be a
variable, as should route. That is, to obtain a tidy dataset we would
need to convert `route` variables from wide to long format. This will be
useful when focusing on specific routes, but may not be necessary when
considering questions that focus on station-level variables.

The following code chunk selects station name and line, and then uses
`distinct()` to obtain all unique combinations. As a result, the number
of rows in this dataset is the number of unique stations.

``` r
trans_ent %>% 
  select(station_name, line) %>% 
  distinct
```

    ## # A tibble: 465 × 2
    ##    station_name             line    
    ##    <chr>                    <chr>   
    ##  1 25th St                  4 Avenue
    ##  2 36th St                  4 Avenue
    ##  3 45th St                  4 Avenue
    ##  4 53rd St                  4 Avenue
    ##  5 59th St                  4 Avenue
    ##  6 77th St                  4 Avenue
    ##  7 86th St                  4 Avenue
    ##  8 95th St                  4 Avenue
    ##  9 9th St                   4 Avenue
    ## 10 Atlantic Av-Barclays Ctr 4 Avenue
    ## # … with 455 more rows

The next code chunk is similar, but filters according to ADA compliance
as an initial step. This produces a dataframe in which the number of
rows is the number of ADA compliant stations.

``` r
trans_ent %>% 
  filter(ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```

    ## # A tibble: 84 × 2
    ##    station_name                   line           
    ##    <chr>                          <chr>          
    ##  1 Atlantic Av-Barclays Ctr       4 Avenue       
    ##  2 DeKalb Av                      4 Avenue       
    ##  3 Pacific St                     4 Avenue       
    ##  4 Grand Central                  42nd St Shuttle
    ##  5 34th St                        6 Avenue       
    ##  6 47-50th Sts Rockefeller Center 6 Avenue       
    ##  7 Church Av                      6 Avenue       
    ##  8 21st St                        63rd Street    
    ##  9 Lexington Av                   63rd Street    
    ## 10 Roosevelt Island               63rd Street    
    ## # … with 74 more rows

To compute the proportion of station entrances / exits without vending
allow entrance, we first exclude station entrances that do not allow
vending. Then, we focus on the `entry` variable – this logical, so
taking the mean will produce the desired proportion (recall that R will
coerce logical to numeric in cases like this).

``` r
trans_ent %>% 
  filter(vending == "NO") %>% 
  pull(entry) %>% 
  mean
```

    ## [1] 0.3770492

Lastly, we write a code chunk to identify stations that serve the A
train, and to assess how many of these are ADA compliant. As a first
step, we tidy the data as alluded to previously; that is, we convert
`route` from wide to long format. After this step, we can use tools from
previous parts of the question (filtering to focus on the A train, and
on ADA compliance; selecting and using `distinct` to obtain dataframes
with the required stations in rows).

``` r
trans_ent %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A") %>% 
  select(station_name, line) %>% 
  distinct
```

    ## # A tibble: 60 × 2
    ##    station_name                  line           
    ##    <chr>                         <chr>          
    ##  1 Times Square                  42nd St Shuttle
    ##  2 125th St                      8 Avenue       
    ##  3 145th St                      8 Avenue       
    ##  4 14th St                       8 Avenue       
    ##  5 168th St - Washington Heights 8 Avenue       
    ##  6 175th St                      8 Avenue       
    ##  7 181st St                      8 Avenue       
    ##  8 190th St                      8 Avenue       
    ##  9 34th St                       8 Avenue       
    ## 10 42nd St                       8 Avenue       
    ## # … with 50 more rows

``` r
trans_ent %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A", ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```

    ## # A tibble: 17 × 2
    ##    station_name                  line            
    ##    <chr>                         <chr>           
    ##  1 14th St                       8 Avenue        
    ##  2 168th St - Washington Heights 8 Avenue        
    ##  3 175th St                      8 Avenue        
    ##  4 34th St                       8 Avenue        
    ##  5 42nd St                       8 Avenue        
    ##  6 59th St                       8 Avenue        
    ##  7 Inwood - 207th St             8 Avenue        
    ##  8 West 4th St                   8 Avenue        
    ##  9 World Trade Center            8 Avenue        
    ## 10 Times Square-42nd St          Broadway        
    ## 11 59th St-Columbus Circle       Broadway-7th Ave
    ## 12 Times Square                  Broadway-7th Ave
    ## 13 8th Av                        Canarsie        
    ## 14 Franklin Av                   Franklin        
    ## 15 Euclid Av                     Fulton          
    ## 16 Franklin Av                   Fulton          
    ## 17 Howard Beach                  Rockaway

# Problem 2

*Mr. Trash Wheel dataset* \* variable names are cleaned \* rows not
containing dumpster values are removed \* note that “dumpster” is a
character variable \* a variable “whee” with value of “mr” has been
applied to all obs, to facilitate tracking and later merging.

*Professor Trashwheel dataset* \* variable names are cleaned \* rows not
containing dumpster values are removed \* a variable “whee” with value
of “prof” has been applied to all obs, to facilitate tracking and later
merging. \* sports_ball is rounded/set to an integer \* note that
dumpster variable was originally numeric. To make it match what is in
the Mr Trashwheels dataset, the variable in Professor Trashwheel is
converted to character

*Combining Mr. Trashwheels & Professor Trashwheels Dataset*

-   Combine both datasets into a dataset called “combo_wheels_tidy”

-   About the Dataset:

There are 525 observations in the resulting dataset. This dataset
demonstrates various categories of collected items (i.e. sports balls,
glass bottles, trash bottles) by weight (in tons), across years (2014 -
2021), for a trash-collection, water-vessel based initiative. This is
helpful for generating summary stats on output and can help compare
productivity between Mr. Trashwheels and Professor Trashwheels. For
example, Mr. Trashwheel collected 135.5 tons, and in the year 2020,
Mr. Trashwheels collected 856 sports balls.

# Problem 3

Import and clean pols-month.csv \* note: data is sorted by year and
month \* year and month were moved to become the leading columns \*
month is a character variable and each value is renamed to their
corresponding month \* president variable was created to denote
affiliation (i.e. dem = Democrat; gop = GOP) \* FYI the dummy variable
was dropped although the indicator variable of 0, 1 is false across
select rows where they are listed as 2. This would require further
inspection.

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(pols_df)
```

    ## # A tibble: 6 × 9
    ##    year month    gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##   <int> <chr>      <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ## 1  1947 April         23      51     253      23      45     198 dem      
    ## 2  1947 April         23      51     253      23      45     198 gop      
    ## 3  1947 August        23      51     253      23      45     198 dem      
    ## 4  1947 August        23      51     253      23      45     198 gop      
    ## 5  1947 December      24      51     253      23      45     198 dem      
    ## 6  1947 December      24      51     253      23      45     198 gop

Import and clean snp.csv \* note: data is sorted by year and month \*
year and month were moved to become the leading columns \* month is a
character variable and each value is renamed to their corresponding
month \* president variable was created to denote affiliation (i.e. dem
= Democrat; gop = GOP)

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(snp_df)
```

    ## # A tibble: 6 × 3
    ##    year month    close
    ##   <dbl> <chr>    <dbl>
    ## 1  1950 April     18.0
    ## 2  1950 August    18.4
    ## 3  1950 December  20.4
    ## 4  1950 February  17.2
    ## 5  1950 January   17.0
    ## 6  1950 July      17.8

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(unemp_df)
```

    ## # A tibble: 6 × 3
    ##    year month    unemp_freq
    ##   <int> <chr>         <dbl>
    ## 1  1948 April           3.9
    ## 2  1948 August          3.9
    ## 3  1948 December        4  
    ## 4  1948 February        3.8
    ## 5  1948 January         3.4
    ## 6  1948 July            3.6

*Joining SNP TO POLS* \* in which pols is the given x data set with 9
columns \* in which snp is the given y data set with 3 columns

``` r
pols_snp_df = 
  left_join(pols_df, snp_df, by = c("year" = "year", "month" = "month"))
```

*Joining unemployment to the SNP/POLS merged dataset*

``` r
pols_snp_unemp_df = 
  left_join(pols_snp_df, unemp_df, by =  c("year" = "year", "month" = "month"))
```

*Combined dataset*

``` r
head(pols_snp_unemp_df)
```

    ## # A tibble: 6 × 11
    ##    year month    gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##   <dbl> <chr>      <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ## 1  1947 April         23      51     253      23      45     198 dem          NA
    ## 2  1947 April         23      51     253      23      45     198 gop          NA
    ## 3  1947 August        23      51     253      23      45     198 dem          NA
    ## 4  1947 August        23      51     253      23      45     198 gop          NA
    ## 5  1947 December      24      51     253      23      45     198 dem          NA
    ## 6  1947 December      24      51     253      23      45     198 gop          NA
    ## # … with 1 more variable: unemp_freq <dbl>

The resulting combined dataset is 11 columns by 1644 rows. The year span
is 1947 to 2015. Key data include the frequency of senators, governors,
and representatives by party affiliation, the party affiliation of the
president, the close number, and the unemployment rates, all by year and
month.
